<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Mozzi: Mozzi.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="custom_stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="mozzi-circle.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Mozzi
   &#160;<span id="projectnumber">version v1.1.0</span>
   </div>
   <div id="projectbrief">sound synthesis library for Arduino</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_mozzi_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">Mozzi.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Compatibility Layer to support the old API.  
<a href="#details">More...</a></p>

<p><a href="_mozzi_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a404f3d01f26d85daad4bba2f085077bf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_mozzi_8cpp.html#a404f3d01f26d85daad4bba2f085077bf">startMozzi</a> (int control_rate_hz)</td></tr>
<tr class="memdesc:a404f3d01f26d85daad4bba2f085077bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets up the timers for audio and control rate processes, storing the timer registers so they can be restored when Mozzi stops.  <a href="_mozzi_8cpp.html#a404f3d01f26d85daad4bba2f085077bf">More...</a><br /></td></tr>
<tr class="separator:a404f3d01f26d85daad4bba2f085077bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d9307490ec05ad28539d513c73a5c20"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_mozzi_8cpp.html#a8d9307490ec05ad28539d513c73a5c20">stopMozzi</a> ()</td></tr>
<tr class="memdesc:a8d9307490ec05ad28539d513c73a5c20"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stops audio and control interrupts and restores the timers to the values they had before Mozzi was started.  <a href="_mozzi_8cpp.html#a8d9307490ec05ad28539d513c73a5c20">More...</a><br /></td></tr>
<tr class="separator:a8d9307490ec05ad28539d513c73a5c20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fca37b988ab369e2f3c3108c683e59d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_mozzi_8cpp.html#a2fca37b988ab369e2f3c3108c683e59d">audioHook</a> ()</td></tr>
<tr class="memdesc:a2fca37b988ab369e2f3c3108c683e59d"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is required in Arduino's loop().  <a href="_mozzi_8cpp.html#a2fca37b988ab369e2f3c3108c683e59d">More...</a><br /></td></tr>
<tr class="separator:a2fca37b988ab369e2f3c3108c683e59d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f15eb8d6694020d170ebcbedb645de7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_mozzi_8cpp.html#a3f15eb8d6694020d170ebcbedb645de7">getAudioInput</a> ()</td></tr>
<tr class="memdesc:a3f15eb8d6694020d170ebcbedb645de7"><td class="mdescLeft">&#160;</td><td class="mdescRight">This returns audio input from the input buffer, if #define USE_AUDIO_INPUT true is in the <a class="el" href="mozzi__config_8h_source.html">Mozzi/mozzi_config.h</a> file.  <a href="_mozzi_8cpp.html#a3f15eb8d6694020d170ebcbedb645de7">More...</a><br /></td></tr>
<tr class="separator:a3f15eb8d6694020d170ebcbedb645de7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa6a42d80c5297407a45ca8bf3c1c7fe"><td class="memItemLeft" align="right" valign="top">unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_mozzi_8cpp.html#aaa6a42d80c5297407a45ca8bf3c1c7fe">mozziMicros</a> ()</td></tr>
<tr class="memdesc:aaa6a42d80c5297407a45ca8bf3c1c7fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">An alternative for Arduino time functions like micros() and millis().  <a href="_mozzi_8cpp.html#aaa6a42d80c5297407a45ca8bf3c1c7fe">More...</a><br /></td></tr>
<tr class="separator:aaa6a42d80c5297407a45ca8bf3c1c7fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55fa9d48f327b646c2f71cef7da7b8f0"><td class="memItemLeft" align="right" valign="top">unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_mozzi_8cpp.html#a55fa9d48f327b646c2f71cef7da7b8f0">audioTicks</a> ()</td></tr>
<tr class="memdesc:a55fa9d48f327b646c2f71cef7da7b8f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">An alternative for Arduino time functions like micros() and millis().  <a href="_mozzi_8cpp.html#a55fa9d48f327b646c2f71cef7da7b8f0">More...</a><br /></td></tr>
<tr class="separator:a55fa9d48f327b646c2f71cef7da7b8f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a52ae84e4e6600c28fd78766b48885f52"><td class="memItemLeft" align="right" valign="top"><a id="a52ae84e4e6600c28fd78766b48885f52"></a>
PLATFORM_OUTPUT_CLASS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_mozzi_8cpp.html#a52ae84e4e6600c28fd78766b48885f52">Mozzi</a></td></tr>
<tr class="memdesc:a52ae84e4e6600c28fd78766b48885f52"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callbacks. <br /></td></tr>
<tr class="separator:a52ae84e4e6600c28fd78766b48885f52"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Compatibility Layer to support the old API. </p>
<dl class="section version"><dt>Version</dt><dd>0.1 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2021-05-10</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright (c) 2021 </dd></dl>

<p class="definition">Definition in file <a class="el" href="_mozzi_8cpp_source.html">Mozzi.cpp</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a2fca37b988ab369e2f3c3108c683e59d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2fca37b988ab369e2f3c3108c683e59d">&#9670;&nbsp;</a></span>audioHook()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void audioHook </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is required in Arduino's loop(). </p>
<p>If there is room in Mozzi's output buffer, <a class="el" href="_mozzi_8cpp.html#a2fca37b988ab369e2f3c3108c683e59d" title="This is required in Arduino&#39;s loop().">audioHook()</a> calls updateAudio() once and puts the result into the output buffer. Also, if #define USE_AUDIO_INPUT true is in <a class="el" href="mozzi__config_8h_source.html">Mozzi/mozzi_config.h</a>, <a class="el" href="_mozzi_8cpp.html#a2fca37b988ab369e2f3c3108c683e59d" title="This is required in Arduino&#39;s loop().">audioHook()</a> takes care of moving audio input from the input buffer so it can be accessed with <a class="el" href="_mozzi_8cpp.html#a3f15eb8d6694020d170ebcbedb645de7" title="This returns audio input from the input buffer, if #define USE_AUDIO_INPUT true is in the Mozzi/mozzi...">getAudioInput()</a> in your updateAudio() routine. If other functions are called in loop() along with <a class="el" href="_mozzi_8cpp.html#a2fca37b988ab369e2f3c3108c683e59d" title="This is required in Arduino&#39;s loop().">audioHook()</a>, see if they can be called less often by moving them into updateControl(), to save processing power. Otherwise it may be most efficient to calculate a block of samples at a time by putting <a class="el" href="_mozzi_8cpp.html#a2fca37b988ab369e2f3c3108c683e59d" title="This is required in Arduino&#39;s loop().">audioHook()</a> in a loop of its own, rather than calculating only 1 sample for each time your other functions are called.</p>
<p>You can use Mozzi.audioHook() instead. </p>

<p class="definition">Definition at line <a class="el" href="_mozzi_8cpp_source.html#l00027">27</a> of file <a class="el" href="_mozzi_8cpp_source.html">Mozzi.cpp</a>.</p>

</div>
</div>
<a id="a55fa9d48f327b646c2f71cef7da7b8f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55fa9d48f327b646c2f71cef7da7b8f0">&#9670;&nbsp;</a></span>audioTicks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long audioTicks </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>An alternative for Arduino time functions like micros() and millis(). </p>
<p>This is slightly faster than micros(), and also it is synchronized with the currently processed audio sample (which, due to the audio output buffer, could diverge up to 256/AUDIO_RATE seconds from the current time). <a class="el" href="_mozzi_8cpp.html#a55fa9d48f327b646c2f71cef7da7b8f0" title="An alternative for Arduino time functions like micros() and millis().">audioTicks()</a> is updated each time an audio sample is output, so the resolution is 1/AUDIO_RATE microseconds (61 microseconds when AUDIO_RATE is 16384 Hz). </p><dl class="section return"><dt>Returns</dt><dd>the number of audio ticks since the program began. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_mozzi_8cpp_source.html#l00041">41</a> of file <a class="el" href="_mozzi_8cpp_source.html">Mozzi.cpp</a>.</p>

</div>
</div>
<a id="a3f15eb8d6694020d170ebcbedb645de7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f15eb8d6694020d170ebcbedb645de7">&#9670;&nbsp;</a></span>getAudioInput()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int getAudioInput </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This returns audio input from the input buffer, if #define USE_AUDIO_INPUT true is in the <a class="el" href="mozzi__config_8h_source.html">Mozzi/mozzi_config.h</a> file. </p>
<p>The pin used for audio input is set in <a class="el" href="mozzi__config_8h_source.html">Mozzi/mozzi_config.h</a> with #define AUDIO_INPUT_PIN 0 (or other analog input pin). The audio signal needs to be in the range 0 to 5 volts. Circuits and discussions about biasing a signal in the middle of this range can be found at <a href="http://electronics.stackexchange.com/questions/14404/dc-biasing-audio-signal">http://electronics.stackexchange.com/questions/14404/dc-biasing-audio-signal</a> and <a href="http://interface.khm.de/index.php/lab/experiments/arduino-realtime-audio-processing/">http://interface.khm.de/index.php/lab/experiments/arduino-realtime-audio-processing/</a> . A circuit and instructions for amplifying and biasing a microphone signal can be found at <a href="http://www.instructables.com/id/Arduino-Audio-Input/?ALLSTEPS">http://www.instructables.com/id/Arduino-Audio-Input/?ALLSTEPS</a> </p><dl class="section return"><dt>Returns</dt><dd>audio data from the input buffer </dd></dl>

<p class="definition">Definition at line <a class="el" href="_mozzi_8cpp_source.html#l00032">32</a> of file <a class="el" href="_mozzi_8cpp_source.html">Mozzi.cpp</a>.</p>

</div>
</div>
<a id="aaa6a42d80c5297407a45ca8bf3c1c7fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa6a42d80c5297407a45ca8bf3c1c7fe">&#9670;&nbsp;</a></span>mozziMicros()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long mozziMicros </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>An alternative for Arduino time functions like micros() and millis(). </p>
<p>This is slightly faster than micros(), and also it is synchronized with the currently processed audio sample (which, due to the audio output buffer, could diverge up to 256/AUDIO_RATE seconds from the current time). <a class="el" href="_mozzi_8cpp.html#a55fa9d48f327b646c2f71cef7da7b8f0" title="An alternative for Arduino time functions like micros() and millis().">audioTicks()</a> is updated each time an audio sample is output, so the resolution is 1/AUDIO_RATE microseconds (61 microseconds when AUDIO_RATE is 16384 Hz). </p><dl class="section return"><dt>Returns</dt><dd>the approximate number of microseconds since the program began. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_mozzi_8cpp_source.html#l00037">37</a> of file <a class="el" href="_mozzi_8cpp_source.html">Mozzi.cpp</a>.</p>

</div>
</div>
<a id="a404f3d01f26d85daad4bba2f085077bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a404f3d01f26d85daad4bba2f085077bf">&#9670;&nbsp;</a></span>startMozzi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void startMozzi </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>control_rate_hz</em> = <code>CONTROL_RATE</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets up the timers for audio and control rate processes, storing the timer registers so they can be restored when Mozzi stops. </p>
<p><a class="el" href="_mozzi_8cpp.html#a404f3d01f26d85daad4bba2f085077bf" title="Sets up the timers for audio and control rate processes, storing the timer registers so they can be r...">startMozzi()</a> goes in your sketch's setup() routine. Contrary to earlier versions of Mozzi, this version does not take over Timer 0, and thus Arduino functions delay(), millis(), micros() and delayMicroseconds() remain usable in theory. That said, you should avoid these functions, as they are slow (or even blocking). For measuring time, refer to mozziMircos(). For delaying events, you can use Mozzi's <a class="el" href="class_event_delay.html" title="A non-blocking replacement for Arduino&#39;s delay() function.">EventDelay()</a> unit instead (not to be confused with <a class="el" href="class_audio_delay.html" title="Audio delay line for comb filter, flange, chorus and short echo effects.">AudioDelay()</a>). In STANDARD mode, <a class="el" href="_mozzi_8cpp.html#a404f3d01f26d85daad4bba2f085077bf" title="Sets up the timers for audio and control rate processes, storing the timer registers so they can be r...">startMozzi()</a> starts Timer 1 for PWM output and audio output interrupts, and in STANDARD_PLUS and HIFI modes, Mozzi uses Timer 1 for PWM and Timer2 for audio interrupts. The audio rate defaults to 16384 Hz, but you can experiment with 32768 Hz by changing AUDIO_RATE in <a class="el" href="mozzi__config_8h_source.html">mozzi_config.h</a>. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">control_rate_hz</td><td>Sets how often updateControl() is called. It must be a power of 2. If no parameter is provided, control_rate_hz is set to CONTROL_RATE, which has a default value of 64 (you can re-#define it in your sketch). The practical upper limit for control rate depends on how busy the processor is, and you might need to do some tests to find the best setting. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>startMozzi calls setupMozziADC(), which calls setupFastAnalogRead() and adcDisconnectAllDigitalIns(), which disables digital inputs on all analog input pins. All in <a class="el" href="mozzi__analog_8h_source.html">mozzi_analog.h</a> and easy to change if you need to (hack). They are all called automatically and hidden away because it keeps things simple for a STANDARD_PLUS set up, but if it turns out to be confusing, they might need to become visible again. You can also use Mozzi.start() instead </dd></dl>

<p class="definition">Definition at line <a class="el" href="_mozzi_8cpp_source.html#l00019">19</a> of file <a class="el" href="_mozzi_8cpp_source.html">Mozzi.cpp</a>.</p>

</div>
</div>
<a id="a8d9307490ec05ad28539d513c73a5c20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d9307490ec05ad28539d513c73a5c20">&#9670;&nbsp;</a></span>stopMozzi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void stopMozzi </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stops audio and control interrupts and restores the timers to the values they had before Mozzi was started. </p>
<p>This could be useful when using sensor libraries which depend on the same timers as Mozzi. A potentially better option for resolving timer conflicts involves using non-blocking methods, such as demonstrated by the twowire_nonblock code in the forked version of Mozzi on github, so sound production can continue while reading sensors. As it is, stopMozzi restores all the Timers used by Mozzi to their previous settings. Another scenario which could be easily hacked in <a class="el" href="_mozzi_guts_8cpp_source.html">MozziGuts.cpp</a> could involve individually saving and restoring particular Timer registers depending on which one(s) are required for other tasks.</p>
<p>You can use Mozzi.stop() instead. </p>

<p class="definition">Definition at line <a class="el" href="_mozzi_8cpp_source.html#l00023">23</a> of file <a class="el" href="_mozzi_8cpp_source.html">Mozzi.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="_mozzi_8cpp.html">Mozzi.cpp</a></li>
    <li class="footer">Generated on Tue Jul 6 2021 23:48:17 for Mozzi by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
